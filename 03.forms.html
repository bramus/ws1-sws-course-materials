<!doctype html>  
<html lang="en">
	
	<head>
		<meta charset="utf-8">
		
		<title>Webscripting1 &mdash; Serverside Webscripting &mdash; 02.forms</title>

		<meta name="description" content="Webscripting1 &mdash; Serverside Webscripting &mdash; 03.forms">
		<meta name="author" content="Bram(us) Van Damme - ikdoeict.be">
		
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
		
		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/main.css" media="screen">
		<link rel="stylesheet" href="css/print.css" media="print">

		<link rel="stylesheet" href="lib/zenburn.css">

		<style>
			.columns .column {
				float: left;
				list-style: none;
				margin: 0 0 12px 0;
				padding: 0;
			}

			.column-12 {
				width: 50%;
			}
			code {
				color: gainsboro;
			}

			li > code, li em > code, li del > code, li ins > code, p > code {
				background: #3F3F3F;
				padding: 2px 4px;
				box-shadow: 0px 0px 6px rgba(0,0,0,0.3);
				font-size: 80%;
			}
			
			del code, code.nok {
				color: #C55;
			}
			
			ins code, code.ok {
				color: #5C5;
			}

			strong {
				color: #553d00;
				background: transparent url('assets/02/strong.png') no-repeat 50% 50%;
				font-size: 80%;
				padding: 0 4px;
				font-family: palatino, times;
				font-weight: 300;
				font-style: italic;
			}

			figure.zoomable-12:hover {
				-moz-transform: scale(1.2);
				-o-transform: scale(1.2);
				-webkit-transform: scale(1.2);
				transform: scale(1.2);
			}

			figure.zoomable-15:hover {
				-moz-transform: scale(1.5);
				-o-transform: scale(1.5);
				-webkit-transform: scale(1.5);
				transform: scale(1.5);
			}

			figure.zoomable-20:hover {
				-moz-transform: scale(2);
				-o-transform: scale(2);
				-webkit-transform: scale(2);
				transform: scale(2);
			}

			#reveal section ul + p > img {
				margin-top: 0;
			}

			#reveal section img.noborder {
				background: transparent;
				border: 0;
				-webkit-box-shadow: none;
				-moz-box-shadow: none;
				-ms-box-shadow: none;
				-o-box-shadow: none;
				box-shadow: none;"
			}

			#reveal section img.noborder + figcaption {
				margin-top: -40px;
				text-align: center;
			}

			#reveal section .zoomable-20 img.noborder + figcaption {
				margin-top: -20px;
			}

			table {
				font-size: 15px;
				border-collapse: collapse;
				width: 100%;
			}

			table td, table th {
				line-height: 1.4;
				border: 1px solid #ccc;
				padding: 4px;
			}

			table th {
				background: #333;
			}
		</style>
	</head>
	
	<body>
		
		<div id="reveal">
			
			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">


				<!-- 0 : Title -->
				<section>

					<section>
						<h3 class="inverted">Serverside Webscripting <small>[JLW274]</small></h3>
						<h1>03.forms</h1>
					
						<footer>
							<em><a href="http://www.ikdoeict.be/">ikdoeict.be</a> &mdash; <a href="mailto:bramus.vandamme@kahosl.be">bramus.vandamme@kahosl.be</a></em>
						</footer>
						<script>
							// Delicously hacky. Look away.
							if( navigator.userAgent.match( /(iPhone|iPad|iPod|Android)/i ) )
							document.write( '<p style="color: rgba(0,0,0,0.3); text-shadow: none;">('+'Tap to navigate'+')</p>' );
						</script>
					</section>

				</section>



				<!-- Before we begin: dump(), $_SERVER, headers -->
				<section>

					<section>
						<h2>Before we begin ...</h2>
					</section>

					<section>
						<h2>Combining HTML and PHP</h2>
						<ul>
							<li class="fragment">All PHP code must be enclosed by <code>&lt;?php</code> and <code>?&gt;</code></li>
							<li class="fragment">Text residing outside <code>&lt;?php</code> and <code>?&gt;</code> does not result in an error but just is not parsed
								<ul>
									<li>
										&rarr; It is perfectly possible to combine HTML and PHP
										<pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/html_and_php.php">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Combining HTML and PHP&lt;/title&gt;
    &lt;meta charset=&quot;UTF-8&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;p&gt;I am HTML&lt;/p&gt;
	&lt;?php echo '&lt;p&gt;I am HTML, generated by PHP&lt;/p&gt;'; ?&gt;
&lt;/body&gt; 
&lt;/html&gt;</code></pre>
									</li>
								</ul>
							</li>
						</ul>
					</section>

					<section>
						<h2>Whitespace in the browser (1)</h2>
						<ul>
							<li class="fragment">
								Echo'ing a <code>PHP_EOL</code> to the browser does not result in a newline on the screen (but it does in the source code)
								<pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/whitespace_01.php">&lt;?php
	for ($i = 0; $i &lt; 5; $i++) {
		echo $i+1 . PHP_EOL;
	}</code></pre>
							</li>
							<li class="fragment">
								You'll also need to output a <code>&lt;br /&gt;</code>
								<pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/whitespace_02.php">&lt;?php
	for ($i = 0; $i &lt; 5; $i++) {
		echo $i+1 . '&lt;br /&gt;' . PHP_EOL;
	}</code></pre>
							</li>
						</ul>

					</section>

					<section>
						<h2>Whitespace in the browser (2)</h2>
						<ul>
							<li class="fragment">
								What about <code>var_dump()</code> or <code>print_r()</code>?
								<pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/whitespace_03.php">&lt;?php
	var_dump($_SERVER);</code></pre>
							</li>
							<li class="fragment">
								No single-line way to convert the newlines to <code>&lt;br /&gt;</code>
								<ul>
									<li>
										&rarr; Luckily HTML provides us with the <code>&lt;pre&gt;</code> element
										<pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/whitespace_04.php">&lt;?php
	function dump($var) {
		echo '&lt;pre&gt;';
		var_dump($var);
		echo '&lt;/pre&gt;';
	}

	dump($_SERVER);</code></pre>
									</li>
								</ul>
							</li>
						</ul>
						<footer class="fragment"><em>Note: <code>$_SERVER</code> is a superglobal holding information about the server and execution environment</em></footer>
					</section>

					<section>
						<h2>Headers (1)</h2>
						<ul>
							<li class="fragment">It's possible to manipulate the headers sent via the <strong>response head</strong> from within PHP</li>
							<li class="fragment">
								Just use the <code>header()</code> function
								<pre class="bigger"><code class="language-php">&lt;?php

	// Instruct the browser to redirect to ikdoeict.be
	header('Location: http://www.ikdoeict.be');</code></pre>
							</li>
						</ul>
					</section>

					<section>
						<h2>Headers (2)</h2>
						<ul>
							<li class="fragment">
								It is recommened to stop the script executing further, as the client will ignore the <em>response body</em> when a redirect header is received.
							</li>
							<li class="fragment">
								Scripts can be stopped prematurely via <code>exit()</code>
								<pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/redirect.php">&lt;?php

	// Instruct the browser to redirect to ikdoeict.be
	header('Location: http://www.ikdoeict.be');
	exit();

	echo 'This line will be ingored';</code></pre>
							</li>
						</ul>
					</section>

					<section>
						<h2>Headers (3)</h2>
						<ul>
							<li class="fragment">
								As per protocol spec, the <em>response head</em> must be sent before <em>response body</em>
							</li>
							<li class="fragment">
								Put differently: once you've started sending the <em>response body</em>, it's impossible to manipulate the <em>response head</em>

								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/redirect_fail.php">&lt;?php

	echo 'Will it blend?';

	header('Location: http://www.ikdoeict.be');
	exit();</code></pre></div>

								<div class="fragment"><pre class="bigger"><code>Warning: Cannot modify header information - headers already sent by (output started at assets/03/examples/redirect_fail.php:3) in assets/03/examples/redirect_fail.php on line 5</code></pre></div>
							</li>
						</ul>
					</section>

				</section>



				<!-- form basics -->
				<section>

					<section>
						<h2>Form Basics</h2>
					</section>

					<section>
						<h2>Example form</h2>
						<div class="fragment">
							<figure>
								<a href="assets/03/examples/form_01.php"><img src="assets/03/testform.jpg" alt="Our testform" title="Our testform" width="700" /></a>
							</figure>
						</div>
						<footer class="fragment">Check the example's HTML code for now, don't send it yet</form>
					</section>

					<section>
						<h2>A proper HTML Form (1)</h2>
						<ul>
							<li class="fragment">
								If your form is built properly, it's easy to work with forms in PHP
							</li>
							<li class="fragment">
								Important HTML <code>&lt;form&gt;</code> attributes
								<ul>
									<li>
										<code>method</code> &mdash; HTTP method to use; <code>get</code> or <code>post</code> (default: <code>get</code>)
									</li>
									<li>
										<code>action</code> &mdash; Where to send the form-data to when submitted
									</li>
									<li>
										<code>enctype</code> &mdash; How the form-data should be encoded when using <code>post</code>
									</li>
								</ul>
							</li>
						</ul>
					</section>

					<section>
						<h2>A proper HTML Form (2)</h2>
						<ul>
							<li class="fragment">
								Always give <code>&lt;input&gt;</code> and <code>&lt;textarea&gt;</code> elements a <code>name</code>
								<ul>
									<li>Radiobuttons: same <code>name</code> in same set</li>
									<li>Checkboxes: same <code>name</code> with square brackets in same set</li>
								</ul>
							</li>
							<li class="fragment">
								Always give	<code>&lt;select&gt;</code> elements a <code>name</code>
								<ul>
									<li>Specify a <code>value</code> for each <code>&lt;option&gt;</code> of the <code>&lt;select&gt;</code></li>
								</ul>
							</li>
							<li class="fragment">
								<code>id</code> attributes not mandatory for proper functioning
								<ul>
									<li>Webbrowsers &amp; servers use the <code>name</code> attributes</li>
									<li>Only to be added for JS purposes</li>
									<li>Remember an <code>id</code> must be unique</li>
								</ul>
							</li>
						</ul>
					</section>

				</section>



				<!-- Handling Forms: Querystring, GET vs. POST -->
				<section>

					<section>
						<h2>Querystring</h2>
					</section>

					<section>
						<h2>Querystring?</h2>
						<ul>
							<li class="fragment">
								Upon submitting your form, the browser will collect all (*) form-data in one text string named the <strong>querystring</strong>
								<ul>
									<li><em>(*) Not all really, more on that later</em></li>
								</ul>
							</li>
							<li class="fragment">
								Querystring format: <code>key=value&amp;key=value&amp;key=value</code>
							</li>
						</ul>
					</section>

					<section>
						<h2>GET vs POST (1)</h2>
						<ul>
							<li class="fragment">
								With <code>GET</code> all values of the querystring are attached to the form's <code>target</code> URL
								<ul>
									<li>The entered values are visible in the URL of the browser</li>
									<li>
										In order to prevent conflicts the values are URL encoded before being attached
										<ul>
											<li>Think <code>&amp;</code> and <code>=</code> that could break the format of the querystring</li>
										</ul>
									</li>
								</ul>
							</li>
							<li class="fragment">
								With <code>POST</code> the querystring is sent in the <em>request body</em>
								<ul>
									<li>
										The entered values are not visible in the URL of the browser, only via sniffing
									</li>
								</ul>
							</li> 
						</ul>
					</section>

					<section>
						<h2>GET vs POST (2)</h2>
						<div style="text-align: center;">
							<figure class="zoomable-15 fragment">
								<img src="assets/03/request-get.jpg" alt="Charles output of a form sent via GET" title="Charles output of a form sent via GET" width="650" />
								<figcaption>Charles output of a form sent via GET</figcaption>
							</figure>
							<figure class="zoomable-15 fragment">
								<img src="assets/03/request-post.jpg" alt="Charles output of a form sent via POST" title="Charles output of a form sent via POST" width="650" />
								<figcaption>Charles output of a form sent via POST</figcaption>
							</figure>
						</div>
					</section>


					<section>
						<h2>URL Encoding</h2>
						<ul>
							<li class="fragment">
								A few frequently used characters
								<table>
									<thead>
										<tr>
											<th>Character</th>
											<th>URL Encoded</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>$</td>
											<td>%24</td>
										</tr>
										<tr>
											<td>&amp;</td>
											<td>%26</td>
										</tr>
										<tr>
											<td>&lt;</td>
											<td>%3C</td>
										</tr>
										<tr>
											<td>&gt;</td>
											<td>%3E</td>
										</tr>
										<tr>
											<td>?</td>
											<td>%3F</td>
										</tr>
										<tr>
											<td>;</td>
											<td>%3B</td>
										</tr>
										<tr>
											<td>#</td>
											<td>%23</td>
										</tr>
										<tr>
											<td>/</td>
											<td>%3A</td>
										</tr>
										<tr>
											<td>=</td>
											<td>%3D</td>
										</tr>
										<tr>
											<td>,</td>
											<td>%2C</td>
										</tr>
										<tr>
											<td>&quot;</td>
											<td>%22</td>
										</tr>
										<tr>
											<td>'</td>
											<td>%27</td>
										</tr>
										<tr>
											<td>+</td>
											<td>%2B</td>
										</tr>
										<tr>
											<td>%</td>
											<td>%25</td>
										</tr>
									</tbody>
								</table>
							</li>
						</ul>
					</section>

					<section>
						<h2>After sending</h2>
						<ul>
							<li class="fragment">
								After sending, the receiving PHP script will decode the querystring and fill some associate arrays with the sent-in values
								<ul>
									<li class="fragment"><code>$_GET</code> &mdash; All values sent via <code>GET</code></li>
									<li class="fragment"><code>$_POST</code> &mdash; All values sent via <code>POST</code></li>
									<li class="fragment">
										<code>$_REQUEST</code> &mdash; All values sent via <code>GET</code> and <code>POST</code>
										<ul>
											<li>Deprecated, don't ever use this!</li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
						<footer class="fragment">These arrays are also known as <a href="http://php.net/manual/en/language.variables.superglobals.php">Superglobals</a></footer>
					</section>

					<section>
						<h2>Querystring revisited</h2>
						<ul>
							<li class="fragment">
								Upon submitting, all form fields are included in the <em>querystring</em>, except:
								<ul>
									<li class="fragment">Controls without a name attribute (<a href="assets/03/examples/form_02.php">demo</a>)</li>
									<li class="fragment">Unchecked radiobuttons (<a href="assets/03/examples/form_03.php">demo</a>)</li>
									<li class="fragment">Disabled controls (<a href="assets/03/examples/form_04.php">demo</a>)</li>
									<li class="fragment">Buttons that were not clicked (<a href="assets/03/examples/form_04.php">demo</a>)</li>
								</ul>
							</li>
						</ul>
					</section>

					<section>
						<h2>Summarized example: our testform</h2>
						<div class="fragment">
							<figure>
								<a href="assets/03/examples/form_05.php"><img src="assets/03/testform.jpg" alt="Our testform" title="Our testform" width="700" /></a>
							</figure>
						</div>
					</section>

					<section>
						<h2>Sidenote: combining GET and POST</h2>
						<ul>
							<li class="fragment">
								Possible if you already have parameters added onto the <code>target</code> URL
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/get_and_post.php">&lt;form action=&quot;form_process.php?foo=getfoo&amp;amp;bar=getbar&quot; method=&quot;post&quot;&gt;

	&lt;fieldset&gt;
		&lt;h2&gt;Get and Post&lt;/h2&gt;
		&lt;dl class=&quot;clearfix&quot;&gt;
			&lt;dt&gt;&lt;label for=&quot;foo&quot;&gt;Foo?&lt;/label&gt;&lt;/dt&gt;
			&lt;dd class=&quot;text&quot;&gt;
				&lt;input type=&quot;text&quot; id=&quot;foo&quot; name=&quot;foo&quot; value=&quot;&quot; /&gt;
			&lt;/dd&gt;

			&lt;dt&gt;&lt;label for=&quot;baz&quot;&gt;Baz?&lt;/label&gt;&lt;/dt&gt;
			&lt;dd class=&quot;text&quot;&gt;
				&lt;input type=&quot;text&quot; id=&quot;baz&quot; name=&quot;baz&quot; value=&quot;&quot; /&gt;
			&lt;/dd&gt;

			&lt;dt class=&quot;full clearfix&quot; id=&quot;lastrow&quot;&gt;
				&lt;input type=&quot;submit&quot; name=&quot;btnSubmit&quot; value=&quot;Send&quot; /&gt;
			&lt;/dt&gt;
		&lt;/dl&gt;
	&lt;/fieldset&gt;
&lt;/form&gt;</code></pre></div>
							</li>
						</ul>
					</section>

					<section>
						<h2>When to use GET or POST (1)</h2>
						<ul>
							<li class="fragment">
								Use <code>POST</code> for sensitive actions
								<ul>
									<li class="fragment">
										Consider these links
										<ul>
											<li><code>index.php?module=blog&amp;action=delete&amp;id=1</code></li>
											<li><code>login.php?username=bramus&amp;password=Azerty123</code></li>
										</ul>
									</li>
									<li class="fragment"><code>GET</code> can be cached by webspiders</li>
									<li class="fragment"><code>GET</code> remains visible in the browser history</li>
									<li class="fragment"><code>GET</code> can be bookmarked and distributed</li>
									<li class="fragment"><code>GET</code> link can become invalid over time</li>
								</ul>
							</li>
							<li class="fragment">
								Use <code>POST</code> when sending files
							</li>
							<li class="fragment">
								Use <code>POST</code> for lengthy data
								<ul>
									<li>(URLS are limited to 2048 characters!</li>
								</ul>
							</li>
						</ul>
					</section>

					<section>
						<h2>When to use GET or POST (2)</h2>
						<ul>
							<li class="fragment">
								Use <code>GET</code> for read actions
								<ul>
									<li class="fragment"><code>showArticle()</code></li>
									<li class="fragment"><code>showComments()</code></li>
									<li class="fragment"><code>getSearchResults()</code></li>
								</ul>
							</li>
							<li class="fragment">
								Use <code>POST</code> for manipulative and sensitive actions
								<ul>
									<li class="fragment"><code>addComment()</code></li>
									<li class="fragment"><code>registerUser()</code></li>
									<li class="fragment"><code>deleteUser()</code></li>
									<li class="fragment"><code>login()</code></li>
								</ul>
							</li>
						</ul>
					</section>

				</section>



				<!-- Persistency -->
				<section>

					<section>
						<h2>Persistency</h2>
					</section>

					<section>
						<h2>Persistency</h2>

						<ul>
							<li class="fragment">
								After having submitted the form to itself, make it show the values you entered
							</li>
							<li class="fragment">
								You can let PHP automatically output the URL of the page itself instead of typing it manually
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_01.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;
	...
&lt;/form&gt;</code></pre></div>
							</li>
							<li class="fragment">
								Different types of inputs (text, checkbox, dropdown) require different persistency methods
							</li>
						</ul>
					</section>

					<section>
						<h2>Persisting text inputs</h2>
						<ul>
							<li class="fragment">
								<code>&lt;input type=&quot;text|password&gt;&quot;</code> and <code>&lt;textarea&gt;</code>
								<ul>
									<li class="fragment">Just output the sent-in value</li>
								</ul>
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_02.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;

	&lt;input type=&quot;text&quot; id=&quot;name&quot; name=&quot;name&quot;
		value=&quot;&lt;?php echo $_GET['name']; ?&gt;&quot; /&gt;

	&lt;input type=&quot;password&quot; id=&quot;pass&quot; name=&quot;pass&quot;
			value=&quot;&lt;?php echo $_GET['pass']; ?&gt;&quot; /&gt;

	&lt;textarea name=&quot;remark&quot; id=&quot;remark&quot; rows=&quot;5&quot;
		cols=&quot;40&quot;&gt;&lt;?php echo $_GET['remark']; ?&gt;&lt;/textarea&gt;

&lt;/form&gt;</code></pre></div>
							</li>
						</ul>
					</section>

					<section>
						<h2>Persisting dropdowns</h2>
						<ul>
							<li class="fragment">
								<code>&lt;select&gt;</code>
								<ul>
									<li class="fragment">For each <code>&lt;option&gt;</code>, check if the value matches the sent-in value</em></li>
									<li class="fragment">If so: set the <code>selected=&quot;selected&quot;</code> attribute</li>
								</ul>
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_04.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;
	&lt;select name=&quot;cont&quot; id=&quot;cont&quot;&gt;
		&lt;option value=&quot;0&quot;&lt;?php if ((int) $_GET['cont'] === 0) { echo ' selected=&quot;selected&quot;'; } ?&gt;&gt;Please select...&lt;/option&gt;
		&lt;option value=&quot;1&quot;&lt;?php if ((int) $_GET['cont'] === 1) { echo ' selected=&quot;selected&quot;'; } ?&gt;&gt;Africa&lt;/option&gt;
		&lt;option value=&quot;2&quot;&lt;?php if ((int) $_GET['cont'] === 2) { echo ' selected=&quot;selected&quot;'; } ?&gt;&gt;America&lt;/option&gt;
		&lt;option value=&quot;3&quot;&lt;?php if ((int) $_GET['cont'] === 3) { echo ' selected=&quot;selected&quot;'; } ?&gt;&gt;Antarctica&lt;/option&gt;
		&lt;option value=&quot;4&quot;&lt;?php if ((int) $_GET['cont'] === 4) { echo ' selected=&quot;selected&quot;'; } ?&gt;&gt;Asia&lt;/option&gt;
		&lt;option value=&quot;5&quot;&lt;?php if ((int) $_GET['cont'] === 5) { echo ' selected=&quot;selected&quot;'; } ?&gt;&gt;Europe&lt;/option&gt;
		&lt;option value=&quot;6&quot;&lt;?php if ((int) $_GET['cont'] === 6) { echo ' selected=&quot;selected&quot;'; } ?&gt;&gt;Oceania&lt;/option&gt;
	&lt;/select&gt;
&lt;/form&gt;</code></pre></div>
							</li>
						</ul>
					</section>

					<section>
						<h2>Persisting radiobtns &amp; checkboxes</h2>
						<ul>
							<li class="fragment">
								<code>&lt;input type=&quot;radio|checkbox&gt;&quot;</code>
								<ul>
									<li class="fragment">For each radiobutton, check if the value matches the sent-in value</li>
									<li class="fragment">If so: set the <code>checked=&quot;checked&quot;</code> attribute</li>
								</ul>
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_05.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;

	&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;male&quot;&lt;?php if ($_GET['gender']
		 === 'male') { echo ' checked=&quot;checked&quot;'; } ?&gt; /&gt;
	&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;female&quot;&lt;?php if ($_GET['gender']
		 === 'female') { echo ' checked=&quot;checked&quot;'; } ?&gt; /&gt;
						
	&lt;input type=&quot;checkbox&quot; name=&quot;meals[]&quot; value=&quot;breakfast&quot;&lt;?php if (in_array(
		'breakfast', $_GET['meals'])) { echo ' checked=&quot;checked&quot;'; } ?&gt; /&gt;
	&lt;input type=&quot;checkbox&quot; name=&quot;meals[]&quot; value=&quot;lunch&quot;&lt;?php if (in_array(
		'lunch', $_GET['meals'])) { echo ' checked=&quot;checked&quot;'; } ?&gt; /&gt;
	&lt;input type=&quot;checkbox&quot; name=&quot;meals[]&quot; value=&quot;dinner&quot;&lt;?php if (in_array(
		'dinner', $_GET['meals'])) { echo ' checked=&quot;checked&quot;'; } ?&gt; /&gt;
	
&lt;/form&gt;</code></pre></div>
							</li>
						</ul>
					</section>


					<section>
						<h2>That's it?</h2>

						<ul>
							<li class="fragment">
								Not really, as we've been cheating in the code examples by suppressing errors
							</li>
							<li class="fragment">
								In reality there are a few pitfalls
								<ul>
									<li class="fragment">Undefined Index</li>
									<li class="fragment"><code>htmlentities()</code></li>
									<li class="fragment">Magic Quotes (pre PHP 5.4)</li>
								</ul>
							</li>
					</section>

					<section>
						<h2>Pitfall: Undefined Index</h2>
						<ul>
							<li class="fragment">
								When not suppressing errors, with exactly the same PHP code, we get a rather nasty result
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_05.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;
	(same HTML code as before)
&lt;/form&gt;</code></pre></div>
							</li>
							<li class="fragment">
								Problem: before submitting <code>$_GET</code> and <code>$_POST</code> are empty
								<ul>
									<li>
										The code stumbles upon the fact that we want to use a variable such as <code>$_GET['name'];</code> when it in fact is non-existent
									</li>
									<li>
										If we change all error texts with normal data it works fine
									</li>
								</ul>
							</li>
							<li class="fragment">
								Fix: check with <code>isset()</code> if a variable exists before using it
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_06.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;
	&lt;input type=&quot;text&quot; id=&quot;name&quot; name=&quot;name&quot;
	value=&quot;&lt;?php echo isset($_GET['name']) ? $_GET['name'] : ''; ?&gt;&quot; /&gt;
&lt;/form&gt;</code></pre></div>
							</li>
						</ul>
					</section>

					<section>
						<h2>Pitfall: htmlentities()</h2>
						<ul>
							<li class="fragment">
								If we enter some HTML-looking text, we break the form
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_06.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;
	(same HTML code as before)
&lt;/form&gt;</code></pre></div>
							</li>
							<li class="fragment">
								Problem: quotes break the HTML code
								<ul>
									<li class="fragment">
										When entering <code>hello &quot; /&gt; test</code> we get this HTML
										<pre class="bigger"><code>&lt;input type=&quot;text&quot; id=&quot;name&quot; name=&quot;name&quot; value=&quot;hello&quot; /&gt; test&quot; /&gt;</code></pre>
									</li>
								</ul>
							</li>
							<li class="fragment">
								Fix: convert special characters with <code>htmlentites()</code> to their HTML safe / encoded version
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_07.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot;&gt;
	&lt;input type=&quot;text&quot; id=&quot;name&quot; name=&quot;name&quot;
	value=&quot;&lt;?php echo isset($_GET['name']) ? htmlentities($_GET['name']) : ''; ?&gt;&quot; /&gt;
&lt;/form&gt;</code></pre></div>
							</li>
						</ul>
					</section>

					<section>
						<h2>Pitfall: Magic Quotes</h2>
						<ul>
							<li class="fragment">
								In PHP pre 5.4, PHP would add backslashes before quotes in strings if the <em>magic_quotes</em> setting was enabled
								<ul>
									<li class="fragment">
										Problem: If you'd persist such a value, and resubmit the form, you'd see the backslashes double exponentially per submit
									</li>
									<li class="fragment">
										Fix: use <code>stripslashes()</code> but only if <em>magic_quotes</em> is enabled
									</li>
							</li>
						</ul>
						<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/persistency_09.php" data-overlay-height="600">// Guaranteed no slashes (if magic_quotes is on, it strips the slashes)
function stripPostSlashes($string) {
	return (get_magic_quotes_gpc() || get_magic_quotes_runtime())
		? stripslashes($string) : $string;
}</code></pre></div>
						<footer class="fragment"><em>We won't be using this function as we're using PHP 5.4</em></footer>
					</section>

				</section>


				<!-- Formchecking -->
				<section>

					<section>
						<h2>Formchecking</h2>
					</section>

					<section>
						<h2>Formchecking</h2>
						<ul>
							<li class="fragment">
								Don't ever trust user input
								<ul>
									<li class="fragment">Data might be in the wrong format (e.g. dates)</li>
									<li class="fragment">Data might be crafted in a way to harm your server (think <code>htmlentities()</code>)</li>
								</ul>
							</li>
							<li class="fragment">
								Even if a user means no harm, he might just have forgotten to complete a field
							</li>
							<li class="fragment">
								Therefor you must verify all incoming data
								<ul>
									<li>If any data is missing or malformed, inform the user with a proper message</li>
								</ul>
							</li>
							<li class="fragment">
								Tip: Always put your formchecking procedure at the very top of your script.
							</li>
						</ul>
					</section>

					<section>
						<h2>Simple Example</h2>
						<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/formchecking.php" data-overlay-height="600">&lt;?php

	// initial values
	$msgName = '*';

	// form is sent
	if (isset($_POST['btnSubmit'])) {

		$allOk = true;

		// name not set, or empty
		if (!isset($_POST['name']) || ((string) $_POST['name'] === '')) {
			$msgName = 'Please enter your name';
			$allOk = false;
		}

		// end of form check. If $allOk still is true, then the form was sent in correctly
		if ($allOk === true) {
			header('Location: formchecking_thanks.php?name=' . urlencode($_POST['name']));
		}

	}</code></pre></div>
					</section>

					<section>
						<h2>Sidenote: urlencode</h2>
						<ul>
							<li class="fragment">
								When redirecting with a parameter in the URL, you must always <code>urlencode()</code> it manually
								<ul>
									<li>Again, never trust user submitted data</li>
									<li>The browser does this for you when submitting a form, but as we're doing it on the server now &hellip;
								</ul>
							</li>
							<li class="fragment">
								Not encoded
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/redirect_01.php" data-overlay-height="600">$gun = 'smith&amp;wesson';
header('Location: redirect_process.php?gun=' . $gun);
exit(0); // do not forget to exit after redirect</code></pre></div>
							</li>
							<li class="fragment">
								Encoded
								<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/redirect_02.php" data-overlay-height="600">$gun = 'smith&amp;wesson';
header('Location: redirect_process.php?gun=' . urlencode($gun));
exit(0); // do not forget to exit after redirect</code></pre></div>
							</li>
						</ul>
					</section>
				</section>



				<!-- File Uploads -->
				<section>

					<section>
						<h2>File Uploads</h2>
					</section>

					<section>
						<h2>File Uploads</h2>
						<ul>
							<li class="fragment">Preparation
								<ul>
									<li class="fragment">Add the <code>enctype=&quot;multipart/form-data&quot;</code> attribute to the form </li>
									<li class="fragment">Set the form <code>method</code> to <code>post</code></li>
								</ul>
							</li>
							<li class="fragment">
								Handling file uploads
								<ul>
									<li>PHP will fill the <code>$_FILES</code> superglobal with info about each file sent</li>
									<li class="fragment">File uploads are stored in a temp folder on the server, you'll have to move them manually &mdash; see next workshop</li>
								</ul>
							</li>
						</ul>
					</section>

					<section>
						<h2>Demo</h2>
						<div class="fragment"><pre class="bigger"><code class="language-php" data-overlay-example="assets/03/examples/files_01.php" data-overlay-height="600">&lt;form action=&quot;&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;

	&lt;fieldset&gt;

		&lt;h2&gt;Testform&lt;/h2&gt;

		&lt;dl class=&quot;clearfix&quot;&gt;

			&lt;dt&gt;&lt;label for=&quot;image&quot;&gt;Image&lt;/label&gt;&lt;/dt&gt;
			&lt;dd&gt;&lt;input type=&quot;file&quot; id=&quot;image&quot; name=&quot;image&quot; value=&quot;&quot; /&gt;&lt;/dd&gt;

			&lt;dt&gt;
				&lt;input type=&quot;submit&quot; name=&quot;btnSubmit&quot; value=&quot;Send&quot; /&gt;
			&lt;/dt&gt;

		&lt;/dl&gt;

	&lt;/fieldset&gt;

&lt;/form&gt;</code></pre></div>
						<footer class="fragment">Note: it is not possible to persist files!</footer>
					</section>

					<section>
						<h2>Under the hood</h2>
						<ul>
							<li class="fragment">
								The browser will send the file in the as an entity
								<ul>
									<li>Entities are sent in the <strong>client request</strong></li>
									<li>Entities are separated by a <strong>boundary</strong>
										<ul>
											<li>The boundary is randomly generated by the browser</li>
										</ul>
									</li>
									<li>Each entity has it's own headers</li>
								</ul>
							</li>
						</ul>
						<div class="fragment">
							<figure class="zoomable-20">
								<img src="assets/03/files.jpg" alt="Charles output of a file sent via POST" title="Charles output of a file sent via POST" width="500" />
								<figcaption>Charles output of a file sent via POST</figcaption>
							</figure>
						</div>
					</section>

				</section>
				



				<!-- The END -->
				<section>
					<section>
						<h2>Questions?</h2>
						<footer>
							<em><a href="http://www.ikdoeict.be/">ikdoeict.be</a> &mdash; <a href="mailto:bramus.vandamme@kahosl.be">bramus.vandamme@kahosl.be</a></em>
						</footer>
					</section>
				</section>



				<!-- Sources -->
				<section id="sources">
					<section>
						<h2>Sources</h2>
						<ul>
							<li>...</li>
						</ul>
					</section>
				</section>
				
			</div>

			<!-- The navigational controls UI -->
			<aside class="controls">
				<a class="left" href="#">&#x25C4;</a>
				<a class="right" href="#">&#x25BA;</a>
				<a class="up" href="#">&#x25B2;</a>
				<a class="down" href="#">&#x25BC;</a>
				<span id="revealIndex">/</span>
			</aside>
			
			<!-- Index Link -->
			<aside class="back">
				<a href="index.html">&larr; Back to index</a>
			</aside>

			<!-- ikdoeict.be Link -->
			<a href="http://www.ikdoeict.be/" title="ikdoeict.be" id="ikdoeict">ikdoeict.be</a>
			
			<!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
			<div class="progress"><span></span></div>
			
		</div>
		
		<script src="js/reveal.js"></script>
		<script src="lib/highlight.js"></script>
		<script src="lib/prefixfree.js"></script>
		<script src="lib/css-snippets.js"></script>
		<script src="lib/css-edit.js"></script>
		<script src="lib/incrementable.js"></script>
		<script src="js/main.js"></script>

	</body>
</html>